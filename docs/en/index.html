<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>WebAuthn4J Reference</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>WebAuthn4J Reference</h1>
<div class="details">
<span id="revnumber">version 0.20.3-SNAPSHOT</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#web-authentication">1.1. Web Authentication</a></li>
<li><a href="#webauthn4j">1.2. WebAuthn4J</a></li>
<li><a href="#webauthn4j-spring-security">1.3. WebAuthn4J Spring Security</a></li>
<li><a href="#feature">1.4. Feature</a></li>
<li><a href="#requirements">1.5. Requirements</a></li>
<li><a href="#getting-from-maven-central">1.6. Getting from Maven Central</a></li>
<li><a href="#source-code">1.7. Source code</a></li>
<li><a href="#license">1.8. License</a></li>
<li><a href="#contributing">1.9. Contributing</a></li>
</ul>
</li>
<li><a href="#quick-start">2. Quick Start</a>
<ul class="sectlevel2">
<li><a href="#webauthn-verification">2.1. WebAuthn verification</a></li>
<li><a href="#webauthn-assertion-verification">2.2. WebAuthn Assertion verification</a></li>
<li><a href="#apple-app-attest-verification">2.3. Apple App Attest verification</a></li>
</ul>
</li>
<li><a href="#configuration">3. Configuration</a>
<ul class="sectlevel2">
<li><a href="#attestation-statement-validation">3.1. Attestation statement validation</a></li>
<li><a href="#what-webauthn4j-doesnt-offer">3.2. What WebAuthn4J doesn&#8217;t offer</a></li>
</ul>
</li>
<li><a href="#deep-dive">4. Deep-Dive</a>
<ul class="sectlevel2">
<li><a href="#representation-of-an-authenticator">4.1. Representation of an authenticator</a></li>
<li><a href="#authenticator-serialization-and-deserialization">4.2. Authenticator serialization and deserialization</a></li>
<li><a href="#dcappledevice-serialization-and-deserialization">4.3. DCAppleDevice serialization and deserialization</a></li>
<li><a href="#using-fido-ctap2-security-key-in-your-own-application-other-than-webauthn">4.4. Using FIDO CTAP2 Security key in your own application other than WebAuthn</a></li>
<li><a href="#project-modules">4.5. Project Modules</a></li>
<li><a href="#custom-converter-implementation">4.6. Custom converter implementation</a></li>
<li><a href="#custom-validator-implementation">4.7. Custom validator implementation</a></li>
<li><a href="#classes">4.8. Classes</a></li>
<li><a href="#logging">4.9. Logging</a></li>
</ul>
</li>
<li><a href="#known-issues">5. Known Issues</a>
<ul class="sectlevel2">
<li><a href="#androids-resident-key-support">5.1. Android&#8217;s resident key support</a></li>
<li><a href="#firefox">5.2. Firefox</a></li>
<li><a href="#implementation-differences-between-browsers">5.3. Implementation differences between browsers</a></li>
<li><a href="#webauthn4js-ecdaa-support">5.4. WebAuthn4J&#8217;s ECDAA support</a></li>
<li><a href="#webauthn4js-ps256ps384ps512-support">5.5. WebAuthn4J&#8217;s PS256/PS384/PS512 support</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>1. Introduction</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="web-authentication"><a class="anchor" href="#web-authentication"></a>1.1. Web Authentication</h3>
<div class="paragraph">
<p>Web Authentication is a new, secure web application authentication specification standardized under W3C.
By combining local authentication, public-key authentication, per-origin key management, it provides strong authentication to web sites against authentication process attacks like phishing.
Implementation is in progress in major browsers, and the specification offers excellent choices for users who place importance on security and convenience.
Initially, the specification was developed as FIDO 2.0 by the FIDO Alliance, but it has been transferred to W3C.</p>
</div>
</div>
<div class="sect2">
<h3 id="webauthn4j"><a class="anchor" href="#webauthn4j"></a>1.2. WebAuthn4J</h3>
<div class="paragraph">
<p>WebAuthn4J is a portable Java library for WebAuthn and Apple App Attest server side verification.</p>
</div>
</div>
<div class="sect2">
<h3 id="webauthn4j-spring-security"><a class="anchor" href="#webauthn4j-spring-security"></a>1.3. WebAuthn4J Spring Security</h3>
<div class="paragraph">
<p>As a related project of WebAuthn4J, we are developing a wrapper library named <a href="https://github.com/webauthn4j/webauthn4j-spring-security">WebAuthn4J Spring Security</a>
to support WebAuthn with Spring Security.
To introduce WebAuthn in an application built with Spring Security, it is better to use WebAuthn4J Spring Security rather than directly using WebAuthn4J.</p>
</div>
</div>
<div class="sect2">
<h3 id="feature"><a class="anchor" href="#feature"></a>1.4. Feature</h3>
<div class="sect3">
<h4 id="supported-attestation-statement-formats"><a class="anchor" href="#supported-attestation-statement-formats"></a>1.4.1. Supported Attestation Statement Formats</h4>
<div class="paragraph">
<p>All attestation statement formats are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Packed attestation</p>
</li>
<li>
<p>FIDO U2F attestation</p>
</li>
<li>
<p>Android Key attestation</p>
</li>
<li>
<p>Android SafetyNet attestation</p>
</li>
<li>
<p>TPM attestation</p>
</li>
<li>
<p>Apple Anonymous attestation</p>
</li>
<li>
<p>Apple App Attest attestation</p>
</li>
<li>
<p>None attestation</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="conformance"><a class="anchor" href="#conformance"></a>1.4.2. Conformance</h4>
<div class="paragraph">
<p>All mandatory test cases and optional Android Key attestation test cases of <a href="https://fidoalliance.org/certification/functional-certification/conformance/">FIDO2 Test Tools provided by FIDO Alliance</a>
are passed.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since FIDO2 Test Tools runs the test via the REST API of FIDO2 Transport Binding Profile, it is executed through the REST API implementation provided by WebAuthn4j Spring Security.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="requirements"><a class="anchor" href="#requirements"></a>1.5. Requirements</h3>
<div class="sect3">
<h4 id="language-framework"><a class="anchor" href="#language-framework"></a>1.5.1. Language &amp; Framework</h4>
<div class="ulist">
<ul>
<li>
<p>Java8 or later</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="environment"><a class="anchor" href="#environment"></a>1.5.2. Environment</h4>
<div class="ulist">
<ul>
<li>
<p>SecureContext (https or the localhost)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="getting-from-maven-central"><a class="anchor" href="#getting-from-maven-central"></a>1.6. Getting from Maven Central</h3>
<div class="paragraph">
<p>If you are using Maven, just add the webauthn4j as a dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;properties&gt;
  ...
  &lt;!-- Use the latest version whenever possible. --&gt;
  &lt;webauthn4j.version&gt;0.20.2.RELEASE&lt;/webauthn4j.version&gt;
  ...
&lt;/properties&gt;

&lt;dependencies&gt;
  ...
  &lt;dependency&gt;
    &lt;groupId&gt;com.webauthn4j&lt;/groupId&gt;
    &lt;artifactId&gt;webauthn4j-core&lt;/artifactId&gt;
    &lt;version&gt;${webauthn4j.version}&lt;/version&gt;
  &lt;/dependency&gt;
  ...
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="source-code"><a class="anchor" href="#source-code"></a>1.7. Source code</h3>
<div class="paragraph">
<p>Source code for this project is hosted on <a href="https://github.com/webauthn4j/webauthn4j">Github</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>git clone git@github.com:webauthn4j/webauthn4j.git</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="license"><a class="anchor" href="#license"></a>1.8. License</h3>
<div class="paragraph">
<p>WebAuthn4J is an open source software licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache 2.0 license</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="contributing"><a class="anchor" href="#contributing"></a>1.9. Contributing</h3>
<div class="paragraph">
<p>Interested in helping out with WebAuthn4J?
Great!
Your participation in the community is much appreciated!
Please feel free to open issues and send pull-requests.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="quick-start"><a class="anchor" href="#quick-start"></a>2. Quick Start</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WebAuthn is an authentication method that a user registers a public key generated by an authenticator to the server in advance and the server verifies the signature generated by the authenticator with the public key at the time of authentication.</p>
</div>
<div class="paragraph">
<p>This quickstart will focus on how to validate the WebAuthn "attestation" data, which is sent at registration and contains public key and authenticator configuration, and how to validate the WebAuthn "assertion" data, which is sent at authentication and contains signature.
Apple App Attest attestation and assertion validation is also explained later.</p>
</div>
<div class="sect2">
<h3 id="webauthn-verification"><a class="anchor" href="#webauthn-verification"></a>2.1. WebAuthn verification</h3>
<div class="sect3">
<h4 id="webauthn-attestation-verification"><a class="anchor" href="#webauthn-attestation-verification"></a>2.1.1. WebAuthn Attestation verification</h4>
<div class="paragraph">
<p>To validate an attestation on authenticator registration, call <code>WebAuthnManager#validate</code> with a
<code>RegistrationRequest</code> instance as an argument.
If you would like to access the parsed data when an validation error occurred, please use <code>WebAuthnManager#parse</code> to parse the registration request and pass the returned <code>RegistrationData</code> instance to <code>WebAuthnManager#validate</code>
method.</p>
</div>
<div class="paragraph">
<p>The members of <code>RegistrationRequest</code> are the values obtained by the WebAuthn JS API in the front end side.
Transmit from the front end side to the server side in some way.</p>
</div>
<div class="paragraph">
<p><code>RegistrationParameters</code> is an another argument for <code>WebAuthnManager#parse</code> method, and contains server property and validation conditions.</p>
</div>
<div class="paragraph">
<p><code>serverProperty</code> has following members.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>origin</code>, please specify Origin of the site that provides WebAuthn authentication.
WebAuthn specification tells that the authenticator signs the data including Origin recognized by the browser.
WebAuthn4J verifies whether the written Origin (namely, recognized by the browser) matches the specified Origin in <code>serverProperty</code> to prevent phishing attacks, which is a behavior required in WebAuthn specification.</p>
</li>
<li>
<p>For <code>rpId</code>, please set the rpId of the site that provides WebAuthn authentication. rpId is a parameter that specifies the scope of credentials.
For more details, please refer to
<a href="https://www.w3.org/TR/webauthn-1/#relying-party-identifier">WebAuthn specification rpId definition</a>.</p>
</li>
<li>
<p>For <code>challenge</code>, please specify the Challenge issued on WebAuthn JS API call. <code>challenge</code> is a parameter to prevent replay attacks.
By issuing the random byte sequence <code>challenge</code> on server side, signing it with WebAuthn JS API, and verifying the signature on server side, users are protected from the replay attack.
It is the application&#8217;s responsibility for retaining the issued Challenge.</p>
</li>
<li>
<p><code>tokenBindingId</code> is a parameter for Token binding.
If you do not want to use it please specify <code>null</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If validation fails, an exception inheriting <code>ValidationException</code> is thrown.
If validation succeeds, please create an <code>Authenticator</code> instance from the returned value and persist it to the database or something in your application manner.
The instance is required at the time of authentication.
For more details about <code>Authenticator</code> serialization, please refer <a href="./deep-dive.html#authenticator-serialization-and-deserialization">Authenticator serialization and deserialization</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// Client properties
byte[] attestationObject = null /* set attestationObject */;
byte[] clientDataJSON = null /* set clientDataJSON */;
String clientExtensionJSON = null;  /* set clientExtensionJSON */
Set&lt;String&gt; transports = null /* set transports */;

// Server properties
Origin origin = null /* set origin */;
String rpId = null /* set rpId */;
Challenge challenge = null /* set challenge */;
byte[] tokenBindingId = null /* set tokenBindingId */;
ServerProperty serverProperty = new ServerProperty(origin, rpId, challenge, tokenBindingId);

// expectations
boolean userVerificationRequired = false;
boolean userPresenceRequired = true;

RegistrationRequest registrationRequest = new RegistrationRequest(attestationObject, clientDataJSON, clientExtensionJSON, transports);
RegistrationParameters registrationParameters = new RegistrationParameters(serverProperty, userVerificationRequired, userPresenceRequired);
RegistrationData registrationData;
try {
    registrationData = webAuthnManager.parse(registrationRequest);
} catch (DataConversionException e) {
    // If you would like to handle WebAuthn data structure parse error, please catch DataConversionException
    throw e;
}
try {
    webAuthnManager.validate(registrationData, registrationParameters);
} catch (ValidationException e) {
    // If you would like to handle WebAuthn data validation error, please catch ValidationException
    throw e;
}

// please persist Authenticator object, which will be used in the authentication process.
Authenticator authenticator =
        new AuthenticatorImpl( // You may create your own Authenticator implementation to save friendly authenticator name
                registrationData.getAttestationObject().getAuthenticatorData().getAttestedCredentialData(),
                registrationData.getAttestationObject().getAttestationStatement(),
                registrationData.getAttestationObject().getAuthenticatorData().getSignCount()
        );
save(authenticator); // please persist authenticator in your manner</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="webauthn-assertion-verification"><a class="anchor" href="#webauthn-assertion-verification"></a>2.2. WebAuthn Assertion verification</h3>
<div class="paragraph">
<p>To parse and validate an assertion on authentication, call <code>WebAuthnManager#validate</code> with a <code>AuthenticationRequest</code>
instance as an argument.
If you would like to access the parsed data when an validation error occurred, please use
<code>WebAuthnManager#parse</code> to parse the authentication request and pass the returned <code>AuthenticationData</code> instance to <code>WebAuthnManager#validate</code> method.</p>
</div>
<div class="paragraph">
<p>The members of <code>AuthenticationRequest</code> are the values obtained by the WebAuthn JS API in the front end side.
Transmit from the front end side to the server side in some way.</p>
</div>
<div class="paragraph">
<p>AuthenticationParameters is an another argument for WebAuthnManager#parse method, and contains server property, persisted authenticator and validation conditions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// Client properties
byte[] credentialId = null /* set credentialId */;
byte[] userHandle = null /* set userHandle */;
byte[] authenticatorData = null /* set authenticatorData */;
byte[] clientDataJSON = null /* set clientDataJSON */;
String clientExtensionJSON = null /* set clientExtensionJSON */;
byte[] signature = null /* set signature */;

// Server properties
Origin origin = null /* set origin */;
String rpId = null /* set rpId */;
Challenge challenge = null /* set challenge */;
byte[] tokenBindingId = null /* set tokenBindingId */;
ServerProperty serverProperty = new ServerProperty(origin, rpId, challenge, tokenBindingId);

// expectations
List&lt;byte[]&gt; allowCredentials = null;
boolean userVerificationRequired = true;
boolean userPresenceRequired = true;
List&lt;String&gt; expectedExtensionIds = Collections.emptyList();

Authenticator authenticator = load(credentialId); // please load authenticator object persisted in the registration process in your manner

AuthenticationRequest authenticationRequest =
        new AuthenticationRequest(
                credentialId,
                userHandle,
                authenticatorData,
                clientDataJSON,
                clientExtensionJSON,
                signature
        );
AuthenticationParameters authenticationParameters =
        new AuthenticationParameters(
                serverProperty,
                authenticator,
                allowCredentials,
                userVerificationRequired,
                userPresenceRequired
        );

AuthenticationData authenticationData;
try {
    authenticationData = webAuthnManager.parse(authenticationRequest);
} catch (DataConversionException e) {
    // If you would like to handle WebAuthn data structure parse error, please catch DataConversionException
    throw e;
}
try {
    webAuthnManager.validate(authenticationData, authenticationParameters);
} catch (ValidationException e) {
    // If you would like to handle WebAuthn data validation error, please catch ValidationException
    throw e;
}
// please update the counter of the authenticator record
updateCounter(
        authenticationData.getCredentialId(),
        authenticationData.getAuthenticatorData().getSignCount()
);</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="apple-app-attest-verification"><a class="anchor" href="#apple-app-attest-verification"></a>2.3. Apple App Attest verification</h3>
<div class="paragraph">
<p>Next, how to verify Apple App Attest is explained.
Since Apple App Attest has a data structure similar to WebAuthn, the validator design follows that of WebAuthn.
Risk metric evaluation is not supported for now.</p>
</div>
<div class="sect3">
<h4 id="getting-from-maven-central-2"><a class="anchor" href="#getting-from-maven-central-2"></a>2.3.1. Getting from Maven Central</h4>
<div class="paragraph">
<p>Apple App Attest validators are contained in the dedicated <code>webauthn4j-device-check</code> module.
If you are using maven, add the <code>webauthn4j-device-check</code> as a dependency in this way:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="xml">&lt;properties&gt;
  ...
  &lt;!-- Use the latest version whenever possible. --&gt;
  &lt;webauthn4j.version&gt;0.13.0.RELEASE&lt;/webauthn4j.version&gt;
  ...
&lt;/properties&gt;

&lt;dependencies&gt;
  ...
  &lt;dependency&gt;
    &lt;groupId&gt;com.webauthn4j&lt;/groupId&gt;
    &lt;artifactId&gt;webauthn4j-device-check&lt;/artifactId&gt;
    &lt;version&gt;${webauthn4j.version}&lt;/version&gt;
  &lt;/dependency&gt;
  ...
&lt;/dependencies&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="apple-app-attest-attestation-verification"><a class="anchor" href="#apple-app-attest-attestation-verification"></a>2.3.2. Apple App Attest attestation verification</h4>
<div class="paragraph">
<p>To validate an attestation on authenticator registration, call <code>DeviceCheckManager#validate</code> with a
<code>DCAttestationRequest</code> instance as an argument.
If you would like to access the parsed data when an validation error occurred, please use <code>DeviceCheckManager#parse</code> to parse the attestation request and pass the returned <code>DCAttestationData</code> instance to <code>DeviceCheckManager#validate</code>
method.</p>
</div>
<div class="paragraph">
<p>The members of <code>DCAttestationRequest</code> are the values obtained by the Apple App Attest API in the iOS device Transmit from the iOS device to the server side in some way.</p>
</div>
<div class="paragraph">
<p><code>DCAttestationParameters</code> is an another argument for <code>DeviceCheckManager#parse</code> method, and contains server property and validation conditions.</p>
</div>
<div class="paragraph">
<p><code>DCServerProperty</code> has following members.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For <code>teamIdentifier</code>, please set the teamIdentifier used for your iOS App development.
For more details, please refer to
<a href="https://developer.apple.com/documentation/devicecheck/validating_apps_that_connect_to_your_server">Validating Apps that connect to your server</a>.</p>
</li>
<li>
<p>For <code>cfBundleIdentifier</code>, please set the cfBundleIdentifier used for your iOS App development.
For more details, please refer to
<a href="https://developer.apple.com/documentation/devicecheck/validating_apps_that_connect_to_your_server">Validating Apps that connect to your server</a>.</p>
</li>
<li>
<p>For <code>challenge</code>, please specify the Challenge issued on App Attest API call. <code>challenge</code> is a parameter to prevent replay attacks.
By issuing the random byte sequence <code>challenge</code> on server side, signing it with App Attest API, and verifying the signature on server side, users are protected from the replay attack.
It is the application&#8217;s responsibility for retaining the issued Challenge.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If validation fails, an exception inheriting <code>ValidationException</code> is thrown.
If validation succeeds, please create an <code>DCAppleDevice</code> instance from the returned value and persist it to the database or something in your application manner.
The instance is required at the time of authentication.</p>
</div>
<div class="sect4">
<h5 id="production-environment-development-environment"><a class="anchor" href="#production-environment-development-environment"></a>Production environment? Development environment?</h5>
<div class="paragraph">
<p>Apple App Attest can return a development attestation for development.
By default, webAuthn4j-device-check is set to accept a production attestation.
If you want to accept a development attestation, you need to <code>DCAttestationDataValidator#setProduction</code> <code>false</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// Client properties
byte[] keyId = null; /* set keyId */
byte[] attestationObject = null; /* set attestationObject */
byte[] challenge = null; /* set challenge */
byte[] clientDataHash = MessageDigestUtil.createSHA256().digest(challenge);

// Server properties
String teamIdentifier = null /* set teamIdentifier */;
String cfBundleIdentifier = null /* set cfBundleIdentifier */;
DCServerProperty dcServerProperty = new DCServerProperty(teamIdentifier, cfBundleIdentifier, new DefaultChallenge(challenge));

DCAttestationRequest dcAttestationRequest = new DCAttestationRequest(keyId, attestationObject, clientDataHash);
DCAttestationParameters dcAttestationParameters = new DCAttestationParameters(dcServerProperty);
DCAttestationData dcAttestationData;
try {
    dcAttestationData = deviceCheckManager.parse(dcAttestationRequest);
} catch (DataConversionException e) {
    // If you would like to handle Apple App Attest data structure parse error, please catch DataConversionException
    throw e;
}
try {
    deviceCheckManager.validate(dcAttestationData, dcAttestationParameters);
} catch (ValidationException e) {
    // If you would like to handle Apple App Attest data validation error, please catch ValidationException
    throw e;
}

// please persist Authenticator object, which will be used in the authentication process.
DCAppleDevice dcAppleDevice =
        new DCAppleDeviceImpl( // You may create your own Authenticator implementation to save friendly authenticator name
                dcAttestationData.getAttestationObject().getAuthenticatorData().getAttestedCredentialData(),
                dcAttestationData.getAttestationObject().getAttestationStatement(),
                dcAttestationData.getAttestationObject().getAuthenticatorData().getSignCount(),
                dcAttestationData.getAttestationObject().getAuthenticatorData().getExtensions()
        );
save(dcAppleDevice); // please persist authenticator in your manner</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="apple-app-attest-assertion-verification"><a class="anchor" href="#apple-app-attest-assertion-verification"></a>2.3.3. Apple App Attest assertion verification</h4>
<div class="paragraph">
<p>To parse and validate an assertion on authentication, call <code>DeviceCheckManager#validate</code> with a <code>DCAssertionRequest</code>
instance as an argument.
If you would like to access the parsed data when an validation error occurred, please use
<code>DeviceCheckManager#parse</code> to parse the authentication request and pass the returned <code>DCAssertionData</code> instance to <code>DeviceCheckManager#validate</code> method.</p>
</div>
<div class="paragraph">
<p>The members of <code>DCAssertionRequest</code> are the values obtained by the App Attest API in the iOS device.
Transmit from the iOS device to the server side in some way.</p>
</div>
<div class="paragraph">
<p>DCAssertionParameters is an another argument for DeviceCheckManager#parse method, and contains server property, persisted authenticator and validation conditions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">// Client properties
byte[] keyId = null /* set keyId */;
byte[] assertion = null /* set assertion */;
byte[] clientDataHash = null /* set clientDataHash */;

// Server properties
String teamIdentifier = null /* set teamIdentifier */;
String cfBundleIdentifier = null /* set cfBundleIdentifier */;
byte[] challenge = null;
DCServerProperty dcServerProperty = new DCServerProperty(teamIdentifier, cfBundleIdentifier, new DefaultChallenge(challenge));

DCAppleDevice dcAppleDevice = load(keyId); // please load authenticator object persisted in the attestation process in your manner

DCAssertionRequest dcAssertionRequest =
        new DCAssertionRequest(
                keyId,
                assertion,
                clientDataHash
        );
DCAssertionParameters dcAssertionParameters =
        new DCAssertionParameters(
                dcServerProperty,
                dcAppleDevice
        );

DCAssertionData dcAssertionData;
try {
    dcAssertionData = deviceCheckManager.parse(dcAssertionRequest);
} catch (DataConversionException e) {
    // If you would like to handle Apple App Attest data structure parse error, please catch DataConversionException
    throw e;
}
try {
    deviceCheckManager.validate(dcAssertionData, dcAssertionParameters);
} catch (ValidationException e) {
    // If you would like to handle Apple App Attest data validation error, please catch ValidationException
    throw e;
}
// please update the counter of the authenticator record
updateCounter(
        dcAssertionData.getCredentialId(),
        dcAssertionData.getAuthenticatorData().getSignCount()
);</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a>3. Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WebAuthn4J has a one main entry point class, <code>WebAuthnManager</code>.
It delegates attestation statements validation to an implementation of
<code>AttestationStatementValidator</code> and attestation statements trustworthiness validation to an implementation of
<code>CertPathTrustworthinessValidator</code>.</p>
</div>
<div class="paragraph">
<p>Since most sites don&#8217;t require strict attestation statement validation (<a href="https://www.w3.org/TR/webauthn-1/#sctn-no-attestation-security-attestation">WebAuthn Spec related topic</a> ), WebAuthn4J provides <code>WebAuthnManager.createNonStrictWebAuthnManager</code> factory method that returns an <code>WebAuthnManager</code> instance configured <code>AttestationStatementValidator</code> and
<code>CertPathTrustworthinessValidator</code> not to validate attestation statements.</p>
</div>
<div class="paragraph">
<p>If you are engaging an enterprise use case and strict authenticator verification is a requirement, Use the constructor of the <code>WebAuthnManager</code> class and inject validators.</p>
</div>
<div class="sect2">
<h3 id="attestation-statement-validation"><a class="anchor" href="#attestation-statement-validation"></a>3.1. Attestation statement validation</h3>
<div class="paragraph">
<p>Attestation statement validation is provided by the implementation of <code>AttestationStatementValidator</code> interface.
For each attestation statement format, corresponding validator classes are provided.
Please specify its list at the first argument of the constructor of <code>WebAuthnManager</code> class.
For example, if you would like to limit the supported format to <code>packed</code> only, add only
<code>PackedAttestationStatementValidator</code> to the <code>List</code>, and if you would like to support <code>packed</code> and <code>tpm</code> format, make the <code>List</code> with <code>PackedAttestationStatementValidator</code> and <code>TPMAttestationStatementValidator</code>.</p>
</div>
<div class="sect3">
<h4 id="attestation-statement-trustworthiness-validation"><a class="anchor" href="#attestation-statement-trustworthiness-validation"></a>3.1.1. Attestation statement trustworthiness validation</h4>
<div class="paragraph">
<p>Attestation statement trustworthiness validation has two patterns: certificate path validation, and self attestation.
Certificate path validation is delegated via <code>CertPathTrustworthinessValidator</code> interface.
WebAuthn4J provides <code>DefaultCertPathTrustworthinessValidator</code> as <code>CertPathTrustworthinessValidator</code> implementation.
<code>DefaultCertPathTrustworthinessValidator</code> verifies trustworthiness by checking the attestation certificate chains to the root certificate provided as <code>TrustAnchor</code> via <code>TrustAnchorRepository</code> interface.</p>
</div>
</div>
<div class="sect3">
<h4 id="trust-anchor-resolution"><a class="anchor" href="#trust-anchor-resolution"></a>3.1.2. Trust anchor resolution</h4>
<div class="paragraph">
<p><code>TrustAnchorRepository</code> is an interface that resolves <code>TrustAnchor</code> from <code>AAGUID</code> or <code>attestationCertificateKeyIdentifier</code>.
<code>webauthn4j-core</code> module provides a <code>KeyStoreTrustAnchorRepository</code> as a <code>TrustAnchorRepository</code>.
<code>KeyStoreTrustAnchorRepository</code> fetches <code>TrustAnchor</code> from a Java Key Store. Please note that
<code>KeyStoreTrustAnchorRepository</code> does not return a different <code>TrustAnchor</code> depending on <code>AAGUID</code> or <code>attestationCertificateKeyIdentifier</code>.
All certificates registered in the Java Key Store file are treated as trust anchors.</p>
</div>
<div class="sect4">
<h5 id="trust-anchor-resolution-using-fido-metadata-service"><a class="anchor" href="#trust-anchor-resolution-using-fido-metadata-service"></a>Trust anchor resolution using FIDO Metadata Service</h5>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<code>webauthn4j-metadata</code> module, which provides FIDO Metadata Statement handling, is under experimental status.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>FIDO Alliance offers FIDO Metadata Service, which provides metadata of authenticators.
<code>webauthn4j-metadata</code> module provides a <code>MetadataBLOBBasedTrustAnchorRepository</code> as a <code>TrustAnchorRepository</code> implementation.
<code>MetadataBLOBBasedTrustAnchorRepository</code> can provide trust anchors based on the information published by FIDO Metadata Service when it is used in combination with <code>FidoMDS3MetadataBLOBProvider</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="what-webauthn4j-doesnt-offer"><a class="anchor" href="#what-webauthn4j-doesnt-offer"></a>3.2. What WebAuthn4J doesn&#8217;t offer</h3>
<div class="paragraph">
<p>In order to realize framework independence, WebAuthn4J intentionally scopes functions to WebAuthn Assertion / Attestation verification.
Fetching parameters from HTTP request, issuing and saving Challenge in session, counter Value validation are not provided.
Please implement in your caller code.
If you are using Spring Security, consider using WebAuthn$J Spring Security as it provides these implementations of authentication framework specific parts.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deep-dive"><a class="anchor" href="#deep-dive"></a>4. Deep-Dive</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="representation-of-an-authenticator"><a class="anchor" href="#representation-of-an-authenticator"></a>4.1. Representation of an authenticator</h3>
<div class="paragraph">
<p>WebAuthn4j provides <code>Authenticator</code> interface as a representation of an authenticator.</p>
</div>
<div class="paragraph">
<p>On registering the authenticator, you need to persist its representation by creating the instance implementing
<code>Authenticator</code> interface in your application manner because it is used afterwards on authentication verification.
It might be better to use credentialId as a search key for this persisted instance.</p>
</div>
<div class="paragraph">
<p>You can freely enhance the class implementing <code>Authenticator</code> interface in order to meet your application&#8217;s requirements.
For example, you can add the field for your application&#8217;s user to identify the authenticator.</p>
</div>
</div>
<div class="sect2">
<h3 id="authenticator-serialization-and-deserialization"><a class="anchor" href="#authenticator-serialization-and-deserialization"></a>4.2. Authenticator serialization and deserialization</h3>
<div class="paragraph">
<p>While it is application&#8217;s responsibility to serialize <code>Authenticator</code> instance at registration, WebAuthn4J provides an utility class to serialize or deserialize members of <code>Authenticator</code> class.
Please use them for implementing persistence in your application.</p>
</div>
<div class="sect3">
<h4 id="attestedcredentialdata"><a class="anchor" href="#attestedcredentialdata"></a>4.2.1. attestedCredentialData</h4>
<div class="paragraph">
<p><code>AttestedCredentialDataConverter</code> converts from <code>AttestedCredentialData</code> to <code>byte[]</code> and vice versa.
If you would like to persist as <code>String</code>, use <code>Base64UrlUtil</code> to convert from <code>byte[]</code> to base64url <code>String</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">AttestedCredentialDataConverter attestedCredentialDataConverter = new AttestedCredentialDataConverter(objectConverter);

// serialize
byte[] serialized = attestedCredentialDataConverter.convert(attestedCredentialData);
// deserialize
AttestedCredentialData deserialized = attestedCredentialDataConverter.convert(serialized);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="attestationstatement"><a class="anchor" href="#attestationstatement"></a>4.2.2. attestationStatement</h4>
<div class="paragraph">
<p>Since <code>AttestationStatement</code> is an interface, there are some implementation classes like <code>PackedAttestationStatement</code> or <code>AndroidKeyAttestationStatement</code> per format.
As <code>AttestationStatement</code> is not self-descriptive for its format, the format need to be persisted in an another field.
Because of that, an envelope class which has attestationStatement field and format field is required, and the envelope class need to be serialized for persisting <code>AttestationStatement</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">AttestationStatementEnvelope attestationStatementEnvelope = new AttestationStatementEnvelope(format, attestationStatement);
byte[] serializedEnvelope = objectConverter.getCborConverter().writeValueAsBytes()</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">static class AttestationStatementEnvelope{

    @JsonProperty("attStmt")
    @JsonTypeInfo(
            use = JsonTypeInfo.Id.NAME,
            include = JsonTypeInfo.As.EXTERNAL_PROPERTY,
            property = "fmt"
    )
    private AttestationStatement attestationStatement;

    @JsonCreator
    public AttestationStatementEnvelope(@JsonProperty("attStmt") AttestationStatement attestationStatement) {
        this.attestationStatement = attestationStatement;
    }

    @JsonProperty("fmt")
    public String getFormat() {
        return attestationStatement.getFormat();
    }

    public AttestationStatement getAttestationStatement() {
        return attestationStatement;
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="transports"><a class="anchor" href="#transports"></a>4.2.3. transports</h4>
<div class="paragraph">
<p>If you would like to persist as JSON <code>String</code>, use <code>ObjectConverter</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">String serializedTransports = objectConverter.getJsonConverter().writeValueAsString(transports);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="counter"><a class="anchor" href="#counter"></a>4.2.4. counter</h4>
<div class="paragraph">
<p>This member is <code>long</code>.
Nothing special is required.</p>
</div>
</div>
<div class="sect3">
<h4 id="authenticatorextensions"><a class="anchor" href="#authenticatorextensions"></a>4.2.5. authenticatorExtensions</h4>
<div class="paragraph">
<p>This member can be serialized as CBOR as it is originally CBOR data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">byte[] serializedAuthenticatorExtensions = objectConverter.getCborConverter().writeValueAsBytes(authenticatorExtensions);</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="clientextensions"><a class="anchor" href="#clientextensions"></a>4.2.6. clientExtensions</h4>
<div class="paragraph">
<p>This member can be serialized as JSON as it is originally JSON data.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code data-lang="java">String serializedClientExtensions = objectConverter.getJsonConverter().writeValueAsString(clientExtensions);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dcappledevice-serialization-and-deserialization"><a class="anchor" href="#dcappledevice-serialization-and-deserialization"></a>4.3. DCAppleDevice serialization and deserialization</h3>
<div class="paragraph">
<p>When you use <code>webauthn4j-device-check</code>, you need to persist <code>DCAppleDevice</code> instead of <code>Authenticator</code> interface between attestation and assertion.
In general, you can serialize and deserialize it by the method explained in <a href="#authenticator-serialization-and-deserialization">Authenticator serialization and deserialization</a>, but <code>ObjectConverter</code> must be the one with <code>DeviceCheckCBORModule</code> registered.
A <code>ObjectConverter</code> with a <code>DeviceCheckCBORModule</code> can be obtained with <code>DeviceCheckManager.createObjectConverter</code> static method.</p>
</div>
</div>
<div class="sect2">
<h3 id="using-fido-ctap2-security-key-in-your-own-application-other-than-webauthn"><a class="anchor" href="#using-fido-ctap2-security-key-in-your-own-application-other-than-webauthn"></a>4.4. Using FIDO CTAP2 Security key in your own application other than WebAuthn</h3>
<div class="paragraph">
<p>For FIDO CTAP2 Security key, WebAuthn is just an application.
An original application can use a a security key too.
This section describes how to use WebAuthn4J for attestation and assertion validation in your own application using the FIDO CTAP2 security key.</p>
</div>
<div class="sect3">
<h4 id="registration-authentication-flow-of-your-own-application-using-fido-ctap2-security-key"><a class="anchor" href="#registration-authentication-flow-of-your-own-application-using-fido-ctap2-security-key"></a>4.4.1. Registration &amp; Authentication flow of your own application using FIDO CTAP2 security key</h4>
<div class="paragraph">
<p>If you use FIDO CTAP2 security key for authentication in your own application, you need to register the security key first.
Call the <a href="https://fidoalliance.org/specs/fido2/fido-client-to-authenticator-protocol-v2.1-rd-20191217.html#authenticatorMakeCredential">authenticatorMakeCredential</a> method of the security key to retrieve the "Attestation" data, which contains public key and device configuration and save it.
The obtained attestation data need to be validated to determine if the security key is acceptable for the application.
WebAuthn4J can validate the attestation with <code>CoreRegistrationValidator</code> class.
For authentication, the application need to call the  <a href="https://fidoalliance.org/specs/fido2/fido-client-to-authenticator-protocol-v2.1-rd-20191217.html#authenticatorGetAssertion">authenticatorGetAssertion</a> method of the security key to retrieve the "assertion" data, which contains signature.
By validating the retrieved assertion, the application can determine whether the security key used for authentication is the same as the one used for registration, and can determine whether the access is legitimate.
WebAuthn4J can validate the assertion with <code>CoreAuthenticationValidator</code> class.</p>
</div>
</div>
<div class="sect3">
<h4 id="how-to-validate-application-specific-client-data"><a class="anchor" href="#how-to-validate-application-specific-client-data"></a>4.4.2. How to validate application specific client data</h4>
<div class="paragraph">
<p>Implementing the above flow will provide authentication feature, but if the entity that calls the FIDO CTAP2 security key (client) and the entity that validates the attestation and the assertion are separated, in some cases, an application specific client data is needed to be validated at the server at registration and authentication.
The client data itself can be sent together with the attestation and assertion, but in order to protect the client data from MITM attacks, it need to be signed and protected.
In FIDO CTAP2 specification, there is a parameter named <code>clientDataHash</code> that is common to <a href="https://fidoalliance.org/specs/fido2/fido-client-to-authenticator-protocol-v2.1-rd-20191217.html#authenticatorMakeCredential">authenticatorMakeCredential</a> method used at registration and <a href="https://fidoalliance.org/specs/fido2/fido-client-to-authenticator-protocol-v2.1-rd-20191217.html#authenticatorGetAssertion">authenticatorGetAssertion</a> method used at authentication.
Since the security key generates a signature from data that contains <code>clientDataHash</code>, an application can validate its specific client data by setting <code>clientDataHash</code> to the hash of the client data and validating the signature.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="project-modules"><a class="anchor" href="#project-modules"></a>4.5. Project Modules</h3>
<div class="paragraph">
<p>WebAuthn4J consists of the following four modules.</p>
</div>
<div class="sect3">
<h4 id="core-webauthn4j-core-jar"><a class="anchor" href="#core-webauthn4j-core-jar"></a>4.5.1. Core webauthn4j-core.jar</h4>
<div class="paragraph">
<p>Provides core features for WebAuthn attestation and assertion verification.</p>
</div>
</div>
<div class="sect3">
<h4 id="core-webauthn4j-device-check-jar"><a class="anchor" href="#core-webauthn4j-device-check-jar"></a>4.5.2. Core webauthn4j-device-check.jar</h4>
<div class="paragraph">
<p>Provides core features for Apple App Attest attestation and assertion verification.</p>
</div>
</div>
<div class="sect3">
<h4 id="metadata-webauthn4j-metadata-jar"><a class="anchor" href="#metadata-webauthn4j-metadata-jar"></a>4.5.3. Metadata webauthn4j-metadata.jar</h4>
<div class="paragraph">
<p>Provides additional features regarding FIDO Metadata Service.
As FIDO Metadata Statement specification is still draft, it is in experimental status.
The included classes don&#8217;t follow semantic versioning and the design may be changed even though it is public.</p>
</div>
</div>
<div class="sect3">
<h4 id="test-webauthn4j-test-jar"><a class="anchor" href="#test-webauthn4j-test-jar"></a>4.5.4. Test webauthn4j-test.jar</h4>
<div class="paragraph">
<p>Internal library for WebAuthn4J testing.
The included classes don&#8217;t follow semantic versioning and the design may be changed even though it is public.</p>
</div>
</div>
<div class="sect3">
<h4 id="util-webauthn4j-util-jar"><a class="anchor" href="#util-webauthn4j-util-jar"></a>4.5.5. Util webauthn4j-util.jar</h4>
<div class="paragraph">
<p>Contains utility classes used in WebAuthn4J library.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="custom-converter-implementation"><a class="anchor" href="#custom-converter-implementation"></a>4.6. Custom converter implementation</h3>
<div class="paragraph">
<p>WebAuthn4J uses Jackson library for JSON and CBOR serialization and deserialization.
If you would like to custom serialization or deserialization, register custom serializer or deserializer to the underlying Jackson <code>ObjectMapper</code>.</p>
</div>
<div class="sect3">
<h4 id="custom-converter-registration"><a class="anchor" href="#custom-converter-registration"></a>4.6.1. Custom converter registration</h4>
<div class="paragraph">
<p>Since WebAuthn4J wraps <code>ObjectMapper</code> with <code>ObjectConverter</code>, inject your customized <code>ObjectMapper</code> through <code>ObjectConverter</code>
constructor and specify the <code>ObjectConverter</code> instance to the <code>WebAuthnManager</code> instance creation parameter.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="custom-validator-implementation"><a class="anchor" href="#custom-validator-implementation"></a>4.7. Custom validator implementation</h3>
<div class="paragraph">
<p>WebAuthn4J can add custom validator.
For registration validation, implement <code>CustomRegistrationValidator</code>.
For authentication validation, implement <code>CustomAuthenticationValidator</code>.</p>
</div>
<div class="sect3">
<h4 id="custom-validator-registration"><a class="anchor" href="#custom-validator-registration"></a>4.7.1. Custom validator registration</h4>
<div class="paragraph">
<p><code>CustomRegistrationValidator</code> and <code>CustomAuthenticationValidator</code> implementation can be registered to <code>WebAuthnManager</code>
via its constructor&#8217;s <code>customRegistrationValidators</code> and <code>customAuthenticationValidators</code> parameters.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="classes"><a class="anchor" href="#classes"></a>4.8. Classes</h3>
<div class="sect3">
<h4 id="data-transfer-objects"><a class="anchor" href="#data-transfer-objects"></a>4.8.1. Data Transfer Objects</h4>
<div class="paragraph">
<p>Classes under <code>com.webauthn4j.data</code> package are designed as immutable DTO.</p>
</div>
</div>
<div class="sect3">
<h4 id="converter-jackson-modules-for-webauthn"><a class="anchor" href="#converter-jackson-modules-for-webauthn"></a>4.8.2. Converter, Jackson Modules for WebAuthn</h4>
<div class="paragraph">
<p>Classes under <code>com.webauthn4j.data</code> package are designed as being serializable and deserializable.</p>
</div>
<div class="paragraph">
<p>Some Classes under <code>converter</code> package needs custom serializer and deserializer.
Jackson&#8217;s module named
<code>WebAuthnJSONModule</code> and <code>WebAuthnCBORModule</code> consolidate these custom serializer and deserializer.
WebAuthn4J’s validators register these modules onto Jackson&#8217;s <code>ObjectMapper</code> automatically.</p>
</div>
<div class="paragraph">
<p>If you want to use WebAuthn4J’s serializer and deserializer outside of WebAuthnManager, you can register these modules onto Jackson&#8217;s <code>ObjectMapper</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="trustanchorsresolver"><a class="anchor" href="#trustanchorsresolver"></a>4.8.3. TrustAnchorsResolver</h4>
<div class="paragraph">
<p><code>TrustAnchorsResolver</code> interface is used by <code>TrustAnchorCertPathTrustworthinessValidator</code> to explore root certificates in the verification of the authenticity of the attestation statements.</p>
</div>
</div>
<div class="sect3">
<h4 id="trustanchorsprovider"><a class="anchor" href="#trustanchorsprovider"></a>4.8.4. TrustAnchorsProvider</h4>
<div class="paragraph">
<p><code>TrustAnchorsProvider</code> is an interface that <code>TrustAnchorsResolverImpl</code> delegates TrustAnchor load operation to.
KeyStoreFileTrustAnchorsProvider is provided as an implementation for loading TrustAnchor from Java Key Store file.
WebAuthn$J Spring Security also provides <code>CertFileResourcesTrustAnchorProvider</code> to load TrustAnchor from Spring Resource.</p>
</div>
</div>
<div class="sect3">
<h4 id="exceptions"><a class="anchor" href="#exceptions"></a>4.8.5. Exceptions</h4>
<div class="paragraph">
<p>If some verification fails, WebAuthn4J throws an exception class inheriting <code>ValidationException</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="logging"><a class="anchor" href="#logging"></a>4.9. Logging</h3>
<div class="paragraph">
<p>WebAuthn4J uses SLF4J as log interface library.
You can use any kind of this implementation like Logback as you want.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="known-issues"><a class="anchor" href="#known-issues"></a>5. Known Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WebAuthn is state of the art technology.
Therefore, there are still some limitations products utilizing it have.
This section tells you issues known at the time of Dec 2019 that might be encountered if you try to use products utilizing WebAuthn technology.</p>
</div>
<div class="sect2">
<h3 id="androids-resident-key-support"><a class="anchor" href="#androids-resident-key-support"></a>5.1. Android&#8217;s resident key support</h3>
<div class="paragraph">
<p>Android&#8217;s FIDO API has not supported resident key yet.
It means Chrome for Android and Firefox for Android don&#8217;t provide username-less authentication experience at the time of authentication.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can mimic such the experience by storing credentialId onto LocalStorage on registration and read it on authentication.
However, it doesn&#8217;t works if a user uses Roaming Authenticator for authentication.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="firefox"><a class="anchor" href="#firefox"></a>5.2. Firefox</h3>
<div class="paragraph">
<p>Firefox supports CTAP2 Authenticators by using OS standard WebAuthn API from Windows 10 1903. However, on macOS and Linux, only FIDO U2F authenticators are supported.</p>
</div>
</div>
<div class="sect2">
<h3 id="implementation-differences-between-browsers"><a class="anchor" href="#implementation-differences-between-browsers"></a>5.3. Implementation differences between browsers</h3>
<div class="paragraph">
<p>Browser vendors has been struggling to support WebAuthn.
However, it is nothing unusual that the feature supported by some platforms are not supported by other platforms.
Considering it, it is recommended to prepare some fallback mechanism for your users using platforms not supporting the feature you expected to support.</p>
</div>
<div class="paragraph">
<p>For example, if you utilize ResidentKey to omit entering user account&#8217;s ID, it might be better to support two-factor authentication requiring password authentication for users using Chrome and Firefox, and two-factor authentication without WebAuthn for users using browsers without WebAuthn support.</p>
</div>
</div>
<div class="sect2">
<h3 id="webauthn4js-ecdaa-support"><a class="anchor" href="#webauthn4js-ecdaa-support"></a>5.4. WebAuthn4J&#8217;s ECDAA support</h3>
<div class="paragraph">
<p>WebAuthn4J has not yet supported ECDAA (Elliptic Curve based Direct Anonymous Attestation) algorithm.
There is no plan to support it for the time being because ECDAA algorithm support is optional by WebAuthn specification and major browsers have not yet supported it.
From WebAuthn Level2 specification, ECDAA is dropped.</p>
</div>
</div>
<div class="sect2">
<h3 id="webauthn4js-ps256ps384ps512-support"><a class="anchor" href="#webauthn4js-ps256ps384ps512-support"></a>5.5. WebAuthn4J&#8217;s PS256/PS384/PS512 support</h3>
<div class="paragraph">
<p>WebAuthn4J has not yet supported PS256, PS384, and PS512 algorithms.
There is no plan to support it for the time being because these algorithms support is optional by WebAuthn specification and standard Providers of Java Crypto API have not yet supported it.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 0.20.3-SNAPSHOT<br>
Last updated 2022-08-04 14:27:52 UTC
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prettify/r298/run_prettify.min.js"></script>
</body>
</html>